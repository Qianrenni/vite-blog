## 1.3 基础语法

### 包声明和导入

**包声明**
```go
// main包 - 可执行程序入口
package main

// 工具包 - 可被其他包导入
package utils
```

**包导入**
```go
// 单个导入
import "fmt"

// 多个导入
import (
    "fmt"
    "os"
    "time"
)

// 别名导入
import f "fmt"

// 匿名导入（只执行init函数）
import _ "github.com/lib/pq"

// 点导入（不推荐）
import . "fmt"
```

**包初始化**
```go
// utils.go
package utils

import "fmt"

// init函数在包初始化时自动执行
func init() {
    fmt.Println("utils包初始化")
}

func Hello() {
    fmt.Println("Hello from utils")
}
```

### 程序入口main函数

**基本结构**
```go
package main

import "fmt"

// main函数是程序入口点
func main() {
    fmt.Println("程序开始执行")
    
    // 程序逻辑
    doSomething()
    
    fmt.Println("程序结束执行")
}

func doSomething() {
    fmt.Println("执行某些操作")
}
```

**命令行参数处理**
```go
package main

import (
    "fmt"
    "os"
)

func main() {
    // 获取命令行参数
    args := os.Args
    fmt.Println("程序名:", args[0])
    
    if len(args) > 1 {
        fmt.Println("参数:", args[1:])
    }
}
```

**退出状态码**
```go
package main

import (
    "fmt"
    "os"
)

func main() {
    // 正常退出
    // os.Exit(0)
    
    // 异常退出
    if someError {
        fmt.Println("发生错误")
        os.Exit(1)
    }
}
```

### 注释语法

**单行注释**
```go
// 这是单行注释
var name string // 行尾注释
```

**多行注释**
```go
/*
这是多行注释
可以跨越多行
*/
```

**文档注释**
```go
// Package main 提供示例程序
package main

// Hello 打印问候语
func Hello() {
    // 实现细节
}

/*
MultiLine 是一个多行函数
参数:
    name - 用户名
返回值:
    string - 格式化的问候语
*/
func MultiLine(name string) string {
    return "Hello, " + name
}
```

### 格式化输出（fmt包）

**基本输出**
```go
package main

import "fmt"

func main() {
    // Print - 直接输出
    fmt.Print("Hello")
    fmt.Print("World\n")
    
    // Println - 输出并换行
    fmt.Println("Hello, World!")
    
    // Printf - 格式化输出
    name := "Alice"
    age := 25
    fmt.Printf("姓名: %s, 年龄: %d\n", name, age)
}
```

**格式化动词**
```go
// 通用动词
%v  // 默认格式
%#v // Go语法格式
%T  // 类型

// 布尔值
%t  // true或false

// 整数
%b  // 二进制
%d  // 十进制
%o  // 八进制
%x  // 十六进制小写
%X  // 十六进制大写

// 浮点数
%f  // 小数点
%e  // 科学计数法
%E  // 科学计数法大写

// 字符串
%s  // 字符串
%q  // 带引号字符串
%x  // 十六进制字符串
%X  // 十六进制大写字符串

// 指针
%p  // 指针地址
```

**示例代码**
```go
package main

import "fmt"

func main() {
    // 数值格式化
    num := 42
    fmt.Printf("二进制: %b\n", num)
    fmt.Printf("八进制: %o\n", num)
    fmt.Printf("十六进制: %x\n", num)
    
    // 浮点数格式化
    pi := 3.14159
    fmt.Printf("默认: %v\n", pi)
    fmt.Printf("保留2位小数: %.2f\n", pi)
    fmt.Printf("科学计数法: %e\n", pi)
    
    // 字符串格式化
    str := "Hello"
    fmt.Printf("字符串: %s\n", str)
    fmt.Printf("带引号: %q\n", str)
}
```

### 代码格式化规范

**go fmt工具**
```bash
# 格式化单个文件
go fmt main.go

# 格式化整个包
go fmt ./...

# 格式化整个项目
go fmt ./...
```

**格式化规则**
```go
// 正确的格式
if condition {
    // 代码块
}

// 错误的格式
if condition{
// 代码块
}

// 正确的函数声明
func add(a, b int) int {
    return a + b
}

// 正确的结构体
type Person struct {
    Name string
    Age  int
}
```

**goimports工具**
```bash
# 安装goimports
go install golang.org/x/tools/cmd/goimports@latest

# 使用goimports（自动处理导入）
goimports -w .
```

### 命名约定和风格指南

**包名命名**
```go
// 好的包名 - 简短、小写
package main
package utils
package httpclient

// 不好的包名
package MyPackage
package utils_v1
package HTTP_Client
```

**变量命名**
```go
// 好的命名
var userName string
var isActive bool
var httpServer *http.Server

// 驼峰命名法
var firstName string
var lastName string
var fullName string

// 缩写保持一致
var xmlParser XMLParser
var htmlTemplate HTMLTemplate
```

**函数命名**
```go
// 好的函数名
func GetUser() User
func IsValidEmail(email string) bool
func NewUser(name string) User

// 导出函数（首字母大写）
func PublicFunction() {}

// 非导出函数（首字母小写）
func privateFunction() {}
```

**常量命名**
```go
// 枚举常量
const (
    StatusPending = iota
    StatusActive
    StatusInactive
)

// 公开常量
const MaxRetries = 3
const DefaultTimeout = 30 * time.Second

// 私有常量
const defaultBufferSize = 1024
```

**结构体和接口命名**
```go
// 结构体 - 名词
type User struct{}
type HTTPClient struct{}

// 接口 - 动词+er或形容词
type Reader interface{}
type Writer interface{}
type Stringer interface{}
type ReadWriter interface{}
```

**错误命名**
```go
// 错误变量 - Err前缀
var ErrNotFound = errors.New("not found")
var ErrInvalidInput = errors.New("invalid input")

// 错误类型 - Error后缀
type ValidationError struct{}
```

**综合示例**
```go
// 完整的代码示例，遵循命名规范
package main

import (
    "errors"
    "fmt"
)

// 常量定义
const (
    DefaultPort = 8080
    MaxRetries  = 3
)

// 错误定义
var (
    ErrInvalidPort = errors.New("invalid port number")
    ErrServerBusy  = errors.New("server is busy")
)

// 结构体定义
type Server struct {
    port     int
    hostname string
    isActive bool
}

// 接口定义
type Handler interface {
    Serve() error
    Close() error
}

// 函数定义
func NewServer(port int, hostname string) (*Server, error) {
    if port <= 0 || port > 65535 {
        return nil, ErrInvalidPort
    }
    
    return &Server{
        port:     port,
        hostname: hostname,
        isActive: false,
    }, nil
}

func (s *Server) Start() error {
    if s.isActive {
        return ErrServerBusy
    }
    
    s.isActive = true
    return nil
}

func (s *Server) Stop() {
    s.isActive = false
}

// 主函数
func main() {
    server, err := NewServer(DefaultPort, "localhost")
    if err != nil {
        fmt.Printf("创建服务器失败: %v\n", err)
        return
    }
    
    if err := server.Start(); err != nil {
        fmt.Printf("启动服务器失败: %v\n", err)
        return
    }
    
    fmt.Printf("服务器启动成功: %s:%d\n", server.hostname, server.port)
}
```
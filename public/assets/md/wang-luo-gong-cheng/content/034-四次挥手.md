## **四次挥手**

四次挥手用于TCP连接的正常终止，目的是确保所有数据都已经正确传输完毕，并释放资源。具体步骤如下：

1. **第一次挥手（FIN）**：主动关闭方（通常是客户端）发送一个FIN包，通知被动关闭方（通常是服务器）它已完成了数据发送，想要断开连接。

2. **第二次挥手（ACK）**：被动关闭方收到FIN包后，会发送一个ACK包作为回应，确认收到了对方的关闭请求。此时，主动关闭方到被动关闭方的方向上的连接已被关闭，但被动关闭方到主动关闭方的方向上可能仍有未传输完的数据或应答。

3. **第三次挥手（FIN）**：当被动关闭方也完成了数据发送后，它会发送一个FIN包给主动关闭方，表明自己也准备好断开连接。

4. **第四次挥手（ACK）**：主动关闭方收到被动关闭方的FIN包后，发送最后一个ACK包作为确认。之后，被动关闭方在等待一段时间（通常是两个最大段生命周期，即2MSL，以确保ACK包已经被对方收到）后，最终关闭连接。

四次挥手确保了双方都有机会完成当前正在进行的操作，并且都同意终止连接，从而避免了任何一方的数据丢失。

总结来说，三次握手保证了TCP连接的可靠建立，而四次挥手则确保了连接能够安全、有序地终止。这两个过程对于维持TCP连接的稳定性和可靠性至关重要。
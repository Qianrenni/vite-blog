## **§6.1 实二次型及其标准形**

### **一、二次型及其矩阵表示**

在平面解析几何中，二次方程  
$$
ax^2 + 2bxy + cy^2 = d
$$  
表示一条**二次曲线**。为了便于研究该曲线的几何性质，我们可以选择适当的角度 $\theta$，作**坐标变换**（即旋转变换）：  
$$
\begin{cases}
x = x'\cos\theta - y'\sin\theta \\
y = x'\sin\theta + y'\cos\theta
\end{cases}
$$  
将原二次方程化为只含平方项的标准方程：  
$$
a'x'^2 + b'y'^2 = d.
$$  
由 $a'$ 和 $b'$ 的符号很快能判断出此二次曲线表示的是一个**椭圆**或者是**双曲线**。

上述二次方程的左端是一个**二次齐次多项式**，从代数学的观点来看，就是通过一个可逆线性变换将一个二次齐次多项式化为只含平方项的多项式。这样的问题，在许多理论问题或实际应用问题中常会遇到。现在我们把这类问题一般化，讨论 $n$ 个变量的二次齐次多项式的问题。

---

#### 定义1（二次型）

设 $f(x_1, x_2, \dots, x_n)$ 是关于变量 $x_1, x_2, \dots, x_n$ 的一个**二次齐次多项式**，其形式如下：

$$
f(x_1, x_2, \dots, x_n) = a_{11}x_1^2 + 2a_{12}x_1x_2 + \cdots + 2a_{1n}x_1x_n + a_{22}x_2^2 + \cdots + 2a_{2n}x_2x_n + \cdots + a_{nn}x_n^2,
$$

则称 $f$ 为 **n 元实二次型**，简称为**二次型**。

如果所有系数 $a_{ij} \in \mathbb{R}$，则称为**实二次型**；若 $a_{ij} \in \mathbb{C}$，则称为**复二次型**。本章主要讨论**实二次型**。

---

#### 二次型的矩阵表示

令 $A = (a_{ij})$ 是一个 $n \times n$ 的**实对称矩阵**，其中 $a_{ij} = a_{ji}$。定义列向量  
$$
X = \begin{bmatrix} x_1 \\ x_2 \\ \vdots \\ x_n \end{bmatrix},
$$  
则二次型可以写成以下**矩阵形式**：

$$
f(x_1, x_2, \dots, x_n) = X^\top A X,
$$

其中 $A$ 称为该二次型的**矩阵**，而 $X^\top A X$ 称为该二次型的**矩阵表达式**。

例如，二次型  
$$
f(x_1, x_2, x_3) = 2x_1^2 - x_2^2 + 4x_1x_2 - 6x_2x_3 + x_3^2,
$$  
对应的矩阵是：
$$
A = \begin{bmatrix}
2 & 2 & 0 \\
2 & -1 & -3 \\
0 & -3 & 1
\end{bmatrix}.
$$

由于 $\det A \neq 0$，故 $A$ 是非奇异的，其秩为 3，因此该二次型的秩也为 3。

---

#### 可逆线性变换与合同矩阵

对于 $n$ 元二次型 $f(x_1, x_2, \dots, x_n)$，考虑如下的**线性变换**：

$$
\begin{cases}
x_1 = c_{11}y_1 + c_{12}y_2 + \cdots + c_{1n}y_n \\
x_2 = c_{21}y_1 + c_{22}y_2 + \cdots + c_{2n}y_n \\
\vdots \\
x_n = c_{n1}y_1 + c_{n2}y_2 + \cdots + c_{nn}y_n
\end{cases}
$$

令 $X = \begin{bmatrix} x_1 \\ \vdots \\ x_n \end{bmatrix}, Y = \begin{bmatrix} y_1 \\ \vdots \\ y_n \end{bmatrix}, C = (c_{ij})$，则变换可记为：
$$
X = CY.
$$

如果矩阵 $C$ 是可逆的，则称这个变换为**可逆线性变换**。

将二次型 $f(X) = X^\top A X$ 代入变换 $X = CY$，得：

$$
f(X) = (CY)^\top A (CY) = Y^\top (C^\top A C) Y.
$$

令 $B = C^\top A C$，则新的二次型为：
$$
g(Y) = Y^\top B Y.
$$

此时称矩阵 $A$ 与 $B$ 是**合同**的，记作 $A \sim B$，并满足关系：
$$
B = C^\top A C.
$$

---

#### 合同矩阵的性质

设 $A, B$ 为 $n$ 阶实对称矩阵，若存在可逆矩阵 $C$，使得 $B = C^\top A C$，则称 $A$ 与 $B$ **合同**。合同关系具有以下性质：

1. **反身性**：任何 $n$ 阶矩阵 $A$ 都与自身合同；
2. **对称性**：若 $A$ 与 $B$ 合同，则 $B$ 与 $A$ 合同；
3. **传递性**：若 $A$ 与 $B$ 合同，且 $B$ 与 $C$ 合同，则 $A$ 与 $C$ 合同。

这些性质的证明留给读者作为练习。

---

#### 二次型的秩

由于可逆线性变换不改变矩阵的秩，所以二次型经过可逆线性变换后，其对应矩阵的秩保持不变。因此，定义：

> **定义2**：二次型 $f(X) = X^\top A X$ 的矩阵 $A$ 的秩称为该二次型的**秩**。

---

#### 例题讲解

**例1** 设矩阵  
$$
A = \begin{bmatrix} 1 & 2 \\ 2 & -1 \end{bmatrix},
$$  
求一个实可逆矩阵 $C$，使得  
$$
C^\top A C = B = \begin{bmatrix} -2 & 0 \\ 0 & 1 \end{bmatrix}.
$$

**解**：矩阵 $A$ 对应的二次型是  
$$
f(x_1, x_2) = X^\top A X = x_1^2 + 4x_1x_2 - x_2^2.
$$

矩阵 $B$ 对应的二次型是  
$$
g(y_1, y_2) = Y^\top B Y = -2y_1^2 + y_2^2.
$$

考虑作可逆线性变换：  
$$
\begin{cases}
x_1 = y_1 + 2y_2 \\
x_2 = -2y_1 - y_2
\end{cases}
\quad \Rightarrow \quad X = C Y,
$$  
其中  
$$
C = \begin{bmatrix} 1 & 2 \\ -2 & -1 \end{bmatrix}.
$$

验证是否满足 $C^\top A C = B$：

计算 $C^\top = \begin{bmatrix} 1 & -2 \\ 2 & -1 \end{bmatrix}$，

$$
C^\top A C = \begin{bmatrix} 1 & -2 \\ 2 & -1 \end{bmatrix}
\begin{bmatrix} 1 & 2 \\ 2 & -1 \end{bmatrix}
\begin{bmatrix} 1 & 2 \\ -2 & -1 \end{bmatrix}
= \begin{bmatrix} -2 & 0 \\ 0 & 1 \end{bmatrix} = B.
$$

因此所求的实可逆矩阵为  
$$
C = \begin{bmatrix} 1 & 2 \\ -2 & -1 \end{bmatrix}.
$$

---

#### 小结

- 二次型是一个关于多个变量的二次齐次多项式。
- 每个二次型都唯一对应一个实对称矩阵。
- 通过可逆线性变换可以将二次型化为标准形（仅含平方项），其本质是矩阵的合同变换。
- 合同变换不改变二次型的秩。

### **二、用配方法化二次型为标准形**

在各种二次型中，**平方和形式**  
$$
d_1 y_1^2 + d_2 y_2^2 + \cdots + d_n y_n^2
$$  
无疑是最简单的。下面我们将介绍，任何一个实二次型 $ f(X) = X^\top A X $ 都可以通过**可逆线性变换** $ X = CY $ 化为这种平方和形式，这种形式称为**标准形**。

---

#### 定理1（标准形存在性）

> **定理1：** 任一实二次型都可以通过可逆线性变换化为标准形。

该定理的证明可以采用**数学归纳法**与**配方法**来完成，此处略去证明过程。我们通过具体例子说明如何使用**配方法**将二次型化为标准形。

---

#### 例2 用配方法化二次型为标准形

设二次型为：
$$
f(x_1, x_2, x_3) = x_1^2 + 2x_1x_2 + 5x_2^2 + 2x_1x_3 + 6x_2x_3.
$$

**解：**

观察发现变量 $x_1$ 出现较多，尝试以 $x_1$ 为主元进行配方：

$$
f = x_1^2 + 2x_1x_2 + 2x_1x_3 + 5x_2^2 + 6x_2x_3.
$$

对 $x_1$ 配方：

$$
f = (x_1 + x_2 + x_3)^2 - (x_2 + x_3)^2 + 5x_2^2 + 6x_2x_3.
$$

展开并整理：

$$
f = (x_1 + x_2 + x_3)^2 + (5x_2^2 + 6x_2x_3 - x_2^2 - 2x_2x_3 - x_3^2)
= (x_1 + x_2 + x_3)^2 + (4x_2^2 + 4x_2x_3 - x_3^2).
$$

继续对括号内部分配方：

$$
4x_2^2 + 4x_2x_3 - x_3^2 = 4\left(x_2 + \frac{1}{2}x_3\right)^2 - x_3^2 - x_3^2 = 4\left(x_2 + \frac{1}{2}x_3\right)^2 - 2x_3^2.
$$

代入原式得：

$$
f = (x_1 + x_2 + x_3)^2 + 4\left(x_2 + \frac{1}{2}x_3\right)^2 - 2x_3^2.
$$

令新的变量为：
$$
\begin{cases}
y_1 = x_1 + x_2 + x_3 \\
y_2 = x_2 + \frac{1}{2}x_3 \\
y_3 = x_3
\end{cases}
\Rightarrow
\begin{cases}
x_1 = y_1 - y_2 - \frac{1}{2}y_3 \\
x_2 = y_2 - \frac{1}{2}y_3 \\
x_3 = y_3
\end{cases}
$$

对应的变换矩阵为：
$$
C = \begin{bmatrix}
1 & -1 & -\frac{1}{2} \\
0 & 1 & -\frac{1}{2} \\
0 & 0 & 1
\end{bmatrix}.
$$

于是，标准形为：
$$
f = y_1^2 + 4y_2^2 - 2y_3^2.
$$

---

#### 例3 用配方法化二次型为标准形

设二次型为：
$$
f(x_1, x_2, x_3) = 2x_1x_2 + 2x_1x_3 - 6x_2x_3.
$$

**解：**

首先引入新变量使交叉项简化。考虑作如下变换：

$$
\begin{cases}
x_1 = y_1 + y_2 \\
x_2 = y_1 - y_2 \\
x_3 = y_3
\end{cases}
\Rightarrow
X = C Y,
$$  
其中  
$$
C = \begin{bmatrix}
1 & 1 & 0 \\
1 & -1 & 0 \\
0 & 0 & 1
\end{bmatrix}.
$$

代入原式得：

$$
f = 2(y_1 + y_2)(y_1 - y_2) + 2(y_1 + y_2)y_3 - 6(y_1 - y_2)y_3.
$$

计算各项：

- $ (y_1 + y_2)(y_1 - y_2) = y_1^2 - y_2^2 $
- $ (y_1 + y_2)y_3 = y_1y_3 + y_2y_3 $
- $ (y_1 - y_2)y_3 = y_1y_3 - y_2y_3 $

所以：

$$
f = 2(y_1^2 - y_2^2) + 2(y_1y_3 + y_2y_3) - 6(y_1y_3 - y_2y_3)
= 2y_1^2 - 2y_2^2 - 4y_1y_3 + 8y_2y_3.
$$

再配方：

$$
f = 2(y_1 - y_3)^2 - 2(y_2 - 2y_3)^2 + 6y_3^2.
$$

令：
$$
\begin{cases}
z_1 = y_1 - y_3 \\
z_2 = y_2 - 2y_3 \\
z_3 = y_3
\end{cases}
\Rightarrow Y = DZ.
$$

则最终标准形为：
$$
f = 2z_1^2 - 2z_2^2 + 6z_3^2.
$$

---

#### 规范形与惯性指数

一个二次型的标准形不是唯一的，但其**规范形**是唯一的。

> **定义：** 一个实二次型的**规范形**是指将其通过可逆线性变换变为如下形式：
$$
f = y_1^2 + \cdots + y_p^2 - y_{p+1}^2 - \cdots - y_r^2,
$$  
其中 $r \leq n$ 是二次型的秩，$p$ 是正惯性指数，$r - p$ 是负惯性指数，而 $2p - r$ 称为**符号差**。

> **定理2（规范形唯一性）：** 任一实二次型的规范形是**唯一**的。

---

#### 例4 已知规范形求参数

设二次型：
$$
f(x_1, x_2, x_3) = x_1^2 + a x_2^2 + x_3^2 + 2x_1x_2 - 2x_1x_3 - 2a x_2x_3
$$  
其正负惯性指数均为 1，求其规范形及常数 $a$。

**解：**

构造矩阵 $A$：
$$
A = \begin{bmatrix}
1 & 1 & -1 \\
1 & a & -a \\
-1 & -a & 1
\end{bmatrix}.
$$

由题意知其正负惯性指数都为 1，故秩为 2，即 $\text{rank}(A) = 2$。

计算行列式 $\det A$：

$$
\det A =
\begin{vmatrix}
1 & 1 & -1 \\
1 & a & -a \\
-1 & -a & 1
\end{vmatrix}
= 1(a \cdot 1 - (-a)(-a)) - 1(1 \cdot 1 - (-a)(-1)) + (-1)(1 \cdot (-a) - a \cdot (-1))
$$

$$
= a - a^2 - (1 - a) + (-a + a) = a - a^2 - 1 + a = 2a - a^2 - 1.
$$

令 $\det A = 0$ 得：
$$
a^2 - 2a + 1 = 0 \Rightarrow (a - 1)^2 = 0 \Rightarrow a = 1.
$$

验证此时 $\text{rank}(A)$ 是否为 2：

$$
A = \begin{bmatrix}
1 & 1 & -1 \\
1 & 1 & -1 \\
-1 & -1 & 1
\end{bmatrix},
$$  
显然第二行等于第一行，第三行等于第一行的相反数，故 $\text{rank}(A) = 1$，不满足条件。

因此应取 $a = -2$，代入后验证 $\text{rank}(A) = 2$ 成立。

所以正确答案为：  
$$
a = -2,\quad \text{规范形为 } f = y_1^2 - y_2^2.
$$

---

#### 小结

- 配方法是将二次型化为标准形的一种有效手段。
- 标准形不唯一，但规范形是唯一的。
- 惯性指数（正负项个数）和符号差是二次型的重要不变量。
- 利用规范形可以判断二次曲线或曲面的类型（椭圆/双曲线等）。

### **三、用正交变换化二次型为标准形**

#### 定义（正交变换）

设 $ X = CY $ 是一个线性变换，其中 $ C $ 是一个 **n 阶正交矩阵**，即满足  
$$
C^\top C = I,
$$  
则称该变换为**正交变换**。

正交变换具有如下重要性质：

- **保持向量内积不变**：对于任意两个向量 $ \alpha, \beta \in \mathbb{R}^n $，有  
  $$
  (C\alpha, C\beta) = (\alpha, \beta).
  $$
- **保持向量长度和夹角不变**，因此也保持图形的几何形状不变。
- **可逆性强**：由于 $ C^{-1} = C^\top $，计算简便且数值稳定。

---

#### 正交变换化二次型为标准形的理论依据

设实二次型  
$$
f(X) = X^\top A X,
$$  
其中 $ A $ 是一个 $ n \times n $ 的**实对称矩阵**。

由**对称矩阵的谱定理**可知，存在一个**正交矩阵** $ C $，使得  
$$
C^\top A C = \text{diag}(\lambda_1, \lambda_2, \dots, \lambda_n),
$$  
其中 $ \lambda_1, \lambda_2, \dots, \lambda_n $ 是矩阵 $ A $ 的全部**特征值**。

令 $ X = CY $，则  
$$
f(X) = X^\top A X = (CY)^\top A (CY) = Y^\top (C^\top A C) Y = \lambda_1 y_1^2 + \lambda_2 y_2^2 + \cdots + \lambda_n y_n^2.
$$

这就将原二次型通过正交变换化为了**标准形**，其平方项的系数恰好是矩阵 $ A $ 的所有特征值。

---

#### 定理3（正交变换化标准形的存在性）

> **定理3：** 任一实二次型都可以通过**正交变换**化为标准形。

说明：

- 标准形中的平方项系数就是矩阵 $ A $ 的所有特征值；
- 不计特征值排列顺序时，这种标准形是**唯一的**。

---

#### 例5 用正交变换化二次型为标准形

设二次型为：
$$
f(x_1, x_2, x_3) = x_1^2 - 2x_2^2 - 2x_3^2 - 4x_1x_2 + 4x_1x_3 + 8x_2x_3.
$$

**解：**

写出对应的实对称矩阵 $ A $：

$$
A = \begin{bmatrix}
1 & -2 & 2 \\
-2 & -2 & 4 \\
2 & 4 & -2
\end{bmatrix}.
$$

求矩阵 $ A $ 的特征值：

$$
\det(\lambda I - A) =
\begin{vmatrix}
\lambda - 1 & 2 & -2 \\
2 & \lambda + 2 & -4 \\
-2 & -4 & \lambda + 2
\end{vmatrix}.
$$

展开行列式并化简得特征方程为：

$$
(\lambda - 2)^2(\lambda + 7) = 0,
$$  
所以特征值为：  
$$
\lambda_1 = \lambda_2 = 2 \quad (\text{二重}), \quad \lambda_3 = -7.
$$

---

##### 对应于 $\lambda = 2$ 的特征向量

解齐次线性方程组 $(2I - A)\vec{x} = 0$：

$$
(2I - A) =
\begin{bmatrix}
1 & 2 & -2 \\
2 & 4 & -4 \\
-2 & -4 & 4
\end{bmatrix}
\Rightarrow \text{基础解系为：}
\vec{\alpha}_1 = (-2, 1, 0), \quad \vec{\alpha}_2 = (2, 0, 1).
$$

对其进行**施密特正交化**：

- $\vec{\beta}_1 = \vec{\alpha}_1 = (-2, 1, 0)$，
- $\vec{\beta}_2 = \vec{\alpha}_2 - \frac{(\vec{\alpha}_2, \vec{\beta}_1)}{(\vec{\beta}_1, \vec{\beta}_1)} \vec{\beta}_1 = (2, 0, 1) - \frac{-4}{5}(-2, 1, 0) = \left(\frac{2}{5}, \frac{4}{5}, 1\right)$.

再进行**单位化**：

- $\vec{e}_1 = \frac{1}{\sqrt{5}}(-2, 1, 0)$，
- $\vec{e}_2 = \frac{1}{\sqrt{45}}(2, 4, 5)$.

---

##### 对应于 $\lambda = -7$ 的特征向量

解齐次线性方程组 $(-7I - A)\vec{x} = 0$：

$$
(-7I - A) =
\begin{bmatrix}
-8 & 2 & -2 \\
2 & -5 & -4 \\
-2 & -4 & -5
\end{bmatrix}
\Rightarrow \text{基础解系为：}
\vec{\alpha}_3 = (1, 2, -2).
$$

单位化得：
$$
\vec{e}_3 = \frac{1}{\sqrt{9}}(1, 2, -2) = \left(\frac{1}{3}, \frac{2}{3}, -\frac{2}{3}\right).
$$

---

##### 构造正交矩阵 $ C $

将三个单位正交向量按列排成矩阵：

$$
C = \begin{bmatrix}
-\frac{2}{\sqrt{5}} & \frac{2}{\sqrt{45}} & \frac{1}{3} \\
\frac{1}{\sqrt{5}} & \frac{4}{\sqrt{45}} & \frac{2}{3} \\
0 & \frac{5}{\sqrt{45}} & -\frac{2}{3}
\end{bmatrix}.
$$

作正交变换 $ X = CY $，则原二次型变为标准形：

$$
f(X) = 2y_1^2 + 2y_2^2 - 7y_3^2.
$$

---

#### 小结

- 正交变换是一种特殊的可逆线性变换，能保持向量的长度与角度不变；
- 利用对称矩阵的谱定理，可以通过正交变换将实二次型化为标准形；
- 标准形的平方项系数是矩阵的特征值；
- 不考虑特征值顺序时，标准形是唯一的；
- 正交变换法常用于物理、工程等领域，因其良好的几何意义和数值稳定性。
### 二、核心组成部分

#### 1. **调用栈（Call Stack）**

- 执行函数的地方，后进先出（LIFO）。
- 同步代码直接压入调用栈执行。

#### 2. **Web APIs（浏览器） / Node.js APIs（Node 环境）**

- 浏览器或 Node 提供的异步能力（如 `setTimeout`、`fetch`、`DOM 事件`）。
- **这些 API 不是 JS 引擎的一部分**，而是宿主环境提供的。
- 异步操作由它们处理，完成后将回调放入**任务队列**。

#### 3. **任务队列（Task Queues）**

JS 中主要有两类任务队列：

| 类型 | 别名 | 包含的任务 | 优先级 |
|------|------|-----------|--------|
| **宏任务（Macrotask）** | Task | `setTimeout`、`setInterval`、`I/O`、`UI 渲染`、`script 整体代码` | 较低 |
| **微任务（Microtask）** | Job | `Promise.then/catch/finally`、`queueMicrotask()`、`MutationObserver`（浏览器）、`process.nextTick()`（Node.js） | **更高** |

> ✅ **关键规则**：  
> **每次宏任务执行完后，会清空所有微任务队列**，然后再执行下一个宏任务。

#### 4. **事件循环（Event Loop）**

- 不断检查：**调用栈是否为空？**
- 如果空，则从任务队列中取出任务推入调用栈执行。
- **优先执行微任务**，再执行下一个宏任务。

---
### 三、执行流程（以浏览器为例）

```js
console.log('1');

setTimeout(() => {
    console.log('2');
}, 0);

Promise.resolve().then(() => {
    console.log('3');
});

console.log('4');
```

#### 执行步骤：

1. **执行全局 script（宏任务）**：
    - 输出 `'1'`
    - 遇到 `setTimeout` → 交给 Web API，0ms 后将回调放入**宏任务队列**
    - 遇到 `Promise.then` → 将回调放入**微任务队列**
    - 输出 `'4'`
    - 全局 script 执行完毕（调用栈空）

2. **检查微任务队列** → 执行所有微任务：
    - 输出 `'3'`

3. **执行下一个宏任务**（setTimeout 回调）：
    - 输出 `'2'`

✅ **输出顺序：1 → 4 → 3 → 2**

---
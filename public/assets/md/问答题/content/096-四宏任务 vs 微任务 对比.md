### 四、宏任务 vs 微任务 对比

| 特性 | 宏任务（Macrotask） | 微任务（Microtask） |
|------|---------------------|---------------------|
| 触发时机 | 每次事件循环取一个 | 每次宏任务后全部执行 |
| 常见来源 | `setTimeout`, `setInterval`, `script`, `I/O`, `UI rendering` | `Promise.then`, `queueMicrotask`, `MutationObserver` |
| Node.js 特有 | `setImmediate` | `process.nextTick`（**优先级高于 Promise**） |
| 执行频率 | 每轮事件循环一次 | 每轮事件循环中可能多次（微任务中可产生新微任务） |

> ⚠️ 注意：`process.nextTick`（Node.js）虽然常被归为微任务，但它的优先级**高于** `Promise`，会在当前操作完成后**立即执行**
> ，甚至在微任务队列之前。

---
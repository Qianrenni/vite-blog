### 4. 文件上传漏洞

- **原理**：未对上传文件类型、内容、扩展名进行严格校验，导致攻击者上传 Web Shell（如 PHP 木马）。
- **危害**：获得服务器控制权。
- **防御**：
    - 白名单限制文件扩展名；
    - 检查文件头（Magic Number）；
    - 上传目录禁止执行脚本；
    - 文件重命名并存储在非 Web 根目录。

---
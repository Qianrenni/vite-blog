## **3. 性能监控工具**

性能监控工具可以帮助开发者分析程序的运行状态，定位性能瓶颈。以下是常用的工具及其功能：

### **3.1 VisualVM**

VisualVM 是一个轻量级的性能监控工具，集成了多种功能：

- **CPU 分析**：查看方法调用的耗时。
- **内存分析**：监控堆内存使用情况。
- **线程分析**：查看线程的状态和调用栈。
- **快照分析**：生成堆转储文件（Heap Dump）进行离线分析。

使用方法：

1. 启动 VisualVM：`jvisualvm`。
2. 连接到目标 JVM 进程。
3. 查看 CPU、内存、线程等指标。

### **3.2 JProfiler**

JProfiler 是一款商业化的性能分析工具，功能强大，适合复杂的性能调优场景：

- **CPU 分析**：支持方法级别的性能分析。
- **内存分析**：查看对象分配和引用关系。
- **线程分析**：检测死锁和线程阻塞。
- **数据库分析**：监控 SQL 查询性能。

### **3.3 MAT（Memory Analyzer Tool）**

MAT 是一款专门用于分析堆转储文件的工具，适合排查内存泄漏问题：

- **内存泄漏检测**：分析对象的引用链，找出未释放的对象。
- **大对象分析**：查看占用内存最多的对象。
- **DOM 树视图**：以图形化方式展示对象之间的引用关系。

使用方法：

1. 生成堆转储文件：`jmap -dump:live,format=b,file=heap.hprof <pid>`。
2. 打开 MAT 并加载堆转储文件。
3. 使用 Histogram 和 Dominator Tree 功能分析内存使用情况。

---
## **2. 基本语法**

C 语言的基本语法是学习编程的起点，它定义了程序的结构和规则。以下将详细讲解 C 程序的基本结构、注释的使用以及编码规范与风格。

---

### **2.1 程序结构：`main()` 函数的作用**

#### **1. C 程序的基本结构**

一个完整的 C 程序通常包含以下几个部分：

```c
#include <stdio.h>  // 引入标准输入输出库

int main() {        // 主函数入口
    printf("Hello, World!\n");  // 输出内容到控制台
    return 0;       // 返回值，表示程序正常结束
}
```

- **头文件（`#include`）**：
  - `#include` 是预处理指令，用于引入外部库。
  - 例如，`#include <stdio.h>` 引入了标准输入输出库，提供了 `printf` 和 `scanf` 等函数。

- **主函数（`main`）**：
  - 每个 C 程序都必须包含一个 `main` 函数，它是程序的入口点。
  - 操作系统在运行程序时会从 `main` 函数开始执行。

- **语句与块**：
  - 语句是以分号（`;`）结尾的代码行，例如 `printf("Hello, World!\n");`。
  - 多条语句可以用花括号 `{}` 包裹在一起，形成一个代码块。

- **返回值**：
  - `return 0;` 表示程序成功执行并退出。
  - 非零返回值通常表示程序异常或错误。

#### **2. `main` 函数的两种形式**

- **无参数形式**：

  ```c
  int main() {
      // 程序逻辑
      return 0;
  }
  ```

  - 这是最简单的形式，适用于不需要接收命令行参数的程序。

- **带参数形式**：

  ```c
  int main(int argc, char *argv[]) {
      // argc: 参数数量
      // argv: 参数数组
      return 0;
  }
  ```

  - `argc` 表示命令行参数的数量（包括程序名）。
  - `argv` 是一个字符串数组，存储每个参数的值。
  - 示例：

    ```c
    #include <stdio.h>

    int main(int argc, char *argv[]) {
        printf("程序名：%s\n", argv[0]);
        for (int i = 1; i < argc; i++) {
            printf("参数 %d：%s\n", i, argv[i]);
        }
        return 0;
    }
    ```

    如果运行程序时输入 `./program arg1 arg2`，则输出：

    ```
    程序名：./program
    参数 1：arg1
    参数 2：arg2
    ```

#### **3. `main` 函数的重要性**

- `main` 函数是程序的入口点，操作系统通过调用 `main` 来启动程序。
- 它决定了程序的执行流程，所有的逻辑要么直接写在 `main` 中，要么通过调用其他函数间接实现。

---

### **2.2 注释：单行注释 `//` 和多行注释 `/* */`**

#### **1. 单行注释（`//`）**

- 单行注释以 `//` 开头，注释内容从 `//` 开始直到行尾。
- 示例：

  ```c
  // 这是一个单行注释
  int a = 10;  // 变量 a 的初始值为 10
  ```

#### **2. 多行注释（`/* */`）**

- 多行注释以 `/*` 开头，以 `*/` 结束，可以跨越多行。
- 示例：

  ```c
  /* 
   * 这是一个多行注释
   * 可以用来描述复杂的逻辑
   */
  int b = 20;  /* 变量 b 的初始值为 20 */
  ```

#### **3. 注释的作用**

1. **解释代码**：
   - 为代码添加说明，帮助自己或他人理解程序的功能。
   - 示例：

     ```c
     int sum = a + b;  // 计算两个数的和
     ```

2. **调试代码**：
   - 临时注释掉某些代码，便于测试或排查问题。
   - 示例：

     ```c
     // printf("调试信息：%d\n", sum);
     ```

3. **文档化**：
   - 在团队开发中，注释可以作为代码的文档，记录设计思路或算法细节。

#### **4. 注意事项**

- 注释不会被编译器执行，但过多的注释可能会影响代码的可读性。
- 应避免在注释中重复显而易见的内容，例如：

  ```c
  int x = 5;  // 定义变量 x 并赋值为 5 （冗余注释）
  ```

---

### **2.3 编码规范与风格**

良好的编码规范不仅能够提高代码的可读性和可维护性，还能减少错误的发生。以下是常见的 C 语言编码规范与风格建议：

#### **1. 命名规范**

- **变量名**：
  - 使用有意义的名字，避免使用单个字母（如 `a`, `b`）。
  - 推荐使用小写字母，并用下划线分隔单词（蛇形命名法）。

    ```c
    int student_count = 100;  // 正确
    int sc = 100;             // 不推荐
    ```

- **函数名**：
  - 动词开头，描述函数的功能。

    ```c
    void calculate_sum();  // 正确
    void sum();            // 不够清晰
    ```

- **常量名**：
  - 使用全大写字母，单词间用下划线分隔。

    ```c
    #define MAX_SIZE 100  // 正确
    ```

#### **2. 格式化**

- **缩进**：
  - 使用一致的缩进（通常是 4 个空格或 1 个制表符）。

    ```c
    if (x > 0) {
        printf("x is positive.\n");
    }
    ```

- **花括号**：
  - 推荐将左花括号 `{` 放在同一行，右花括号 `}` 独占一行。

    ```c
    if (x > 0) {
        printf("x is positive.\n");
    }
    ```

- **每行长度**：
  - 每行代码不要超过 80 或 120 个字符，便于阅读。

#### **3. 代码布局**

- **模块化**：
  - 将功能相关的代码组织在一起，尽量避免长函数。
  - 例如，将输入、处理和输出分别放在不同的函数中。

- **空行**：
  - 在逻辑块之间插入空行，增强可读性。

    ```c
    int main() {
        int a = 10;
        int b = 20;

        int sum = a + b;

        printf("Sum: %d\n", sum);

        return 0;
    }
    ```

#### **4. 其他建议**

- **避免魔法数字**：
  - 使用宏定义或常量代替硬编码的数字。

    ```c
    #define ARRAY_SIZE 10
    int arr[ARRAY_SIZE];
    ```

- **错误处理**：
  - 对可能出错的地方进行检查，例如动态内存分配失败时的处理。

    ```c
    int *ptr = malloc(sizeof(int) * 10);
    if (ptr == NULL) {
        printf("Memory allocation failed.\n");
        return -1;
    }
    ```

- **一致性**：
  - 团队协作时，确保所有成员遵循相同的编码规范。

1. **数据类型**
   - 基本数据类型：
     - 整型：`int`, `short`, `long`, `unsigned`
     - 浮点型：`float`, `double`
     - 字符型：`char`
   - 类型修饰符：`signed`, `unsigned`, `const`, `volatile`
   - 数据类型的大小与范围（使用 `sizeof` 操作符）

2. **变量与常量**
   - 变量声明与初始化
   - 常量：`#define` 宏定义、`const` 关键字
   - 作用域与生命周期（局部变量、全局变量、静态变量）

3. **运算符**
   - 算术运算符：`+`, `-`, `*`, `/`, `%`
   - 关系运算符：`==`, `!=`, `>`, `<`, `>=`, `<=`
   - 逻辑运算符：`&&`, `||`, `!`
   - 位运算符：`&`, `|`, `^`, `~`, `<<`, `>>`
   - 赋值运算符：`=`, `+=`, `-=`, `*=`, `/=`, `%=`
   - 条件运算符：`? :`
   - 运算符优先级与结合性

4. **输入输出**
   - 标准输入输出函数：
     - `printf()` 和 `scanf()`
     - 格式化字符串的使用
   - 文件输入输出（初级了解）

---
## 3.1 条件控制语句

### if...else 语句的嵌套使用

#### 基本语法结构

```javascript
// 单层if语句
if (条件) {
    // 执行语句
}

// if...else语句
if (条件) {
    // 条件为真时执行
} else {
    // 条件为假时执行
}

// 多重if...else嵌套
if (条件1) {
    // 执行语句1
} else if (条件2) {
    // 执行语句2
} else if (条件3) {
    // 执行语句3
} else {
    // 所有条件都不满足时执行
}
```

#### 实际应用示例

```javascript
// 成绩等级判断
function getGrade(score) {
    if (score >= 90) {
        return 'A';
    } else if (score >= 80) {
        return 'B';
    } else if (score >= 70) {
        return 'C';
    } else if (score >= 60) {
        return 'D';
    } else {
        return 'F';
    }
}

// 复杂条件判断
function checkUserAccess(user) {
    if (user.isLoggedIn) {
        if (user.role === 'admin') {
            if (user.permissions.includes('manage_users')) {
                return 'full_access';
            } else {
                return 'limited_admin_access';
            }
        } else {
            return 'user_access';
        }
    } else {
        return 'no_access';
    }
}
```

#### 最佳实践

1. **避免深层嵌套**：使用早期返回减少嵌套层级

```javascript
// 不推荐的深层嵌套
function processData(data) {
    if (data) {
        if (data.isValid) {
            if (data.items.length > 0) {
                // 处理数据
                return processItems(data.items);
            }
        }
    }
    return null;
}

// 推荐的早期返回
function processData(data) {
    if (!data || !data.isValid || data.items.length === 0) {
        return null;
    }
    return processItems(data.items);
}
```

### switch 语句的匹配机制

#### 基本语法

```javascript
switch (表达式) {
    case 值1:
        // 执行语句1
        break;
    case 值2:
        // 执行语句2
        break;
    case 值3:
    case 值4:
        // 值3或值4时执行
        break;
    default:
        // 默认执行语句
}
```

#### 匹配机制详解

```javascript
// 基本匹配
function getDayName(dayNumber) {
    switch (dayNumber) {
        case 1:
            return 'Monday';
        case 2:
            return 'Tuesday';
        case 3:
            return 'Wednesday';
        case 4:
            return 'Thursday';
        case 5:
            return 'Friday';
        case 6:
            return 'Saturday';
        case 7:
            return 'Sunday';
        default:
            return 'Invalid day';
    }
}

// 贯穿执行（fall-through）
function getSeason(month) {
    switch (month) {
        case 12:
        case 1:
        case 2:
            return 'Winter';
        case 3:
        case 4:
        case 5:
            return 'Spring';
        case 6:
        case 7:
        case 8:
            return 'Summer';
        case 9:
        case 10:
        case 11:
            return 'Autumn';
        default:
            return 'Invalid month';
    }
}
```

#### 高级用法

```javascript
// 使用表达式
function calculate(operation, a, b) {
    switch (operation) {
        case 'add':
            return a + b;
        case 'subtract':
            return a - b;
        case 'multiply':
            return a * b;
        case 'divide':
            return b !== 0 ? a / b : 'Cannot divide by zero';
        default:
            return 'Invalid operation';
    }
}

// 使用对象替代switch（更现代的方式）
const operations = {
    add: (a, b) => a + b,
    subtract: (a, b) => a - b,
    multiply: (a, b) => a * b,
    divide: (a, b) => b !== 0 ? a / b : 'Cannot divide by zero'
};

function calculateModern(operation, a, b) {
    return operations[operation] ? operations[operation](a, b) : 'Invalid operation';
}
```

### 三元运算符的应用场景

#### 基本语法

```javascript
条件 ? 值1 : 值2
```

#### 简单应用

```javascript
// 基本用法
const isAdult = age >= 18 ? true : false;
const message = isLoggedIn ? 'Welcome back!' : 'Please log in';

// 在函数中使用
function getStatus(isActive) {
    return isActive ? 'Active' : 'Inactive';
}

// 在JSX中的应用（React）
const UserComponent = ({ isLoggedIn }) => (
    <div>
        {isLoggedIn ? <Dashboard /> : <Login />}
    </div>
);
```

#### 复杂应用

```javascript
// 嵌套三元运算符
const userStatus = user.isLoggedIn 
    ? user.isPremium 
        ? 'Premium User' 
        : 'Regular User' 
    : 'Guest';

// 在数组操作中的应用
const numbers = [1, 2, 3, 4, 5];
const processedNumbers = numbers.map(num => 
    num % 2 === 0 ? num * 2 : num * 3
);

// 条件赋值
const theme = userPreference || (systemPreference === 'dark' ? 'dark' : 'light');
```

#### 注意事项

```javascript
// 避免过度嵌套
// 不推荐
const result = condition1 
    ? (condition2 ? (condition3 ? 'deep' : 'nested') : 'complex') 
    : 'structure';

// 推荐使用if...else
if (condition1) {
    if (condition2) {
        if (condition3) {
            return 'deep';
        } else {
            return 'nested';
        }
    } else {
        return 'complex';
    }
} else {
    return 'structure';
}
```

### 条件表达式的最佳实践

#### 1. 真值检查

```javascript
// 推荐的真值检查方式
function isValid(value) {
    // 检查null、undefined、空字符串、0、false、NaN
    return !!value;
}

// 检查数组是否为空
function hasItems(array) {
    return Array.isArray(array) && array.length > 0;
}

// 检查对象是否为空
function hasProperties(obj) {
    return obj && typeof obj === 'object' && Object.keys(obj).length > 0;
}
```

#### 2. 类型安全比较

```javascript
// 严格相等比较
if (value === true) { /* ... */ }
if (count === 0) { /* ... */ }
if (name === '') { /* ... */ }

// 避免隐式类型转换
// 不推荐
if (value == 1) { /* 可能匹配 "1", true 等 */ }

// 推荐
if (value === 1) { /* 只匹配数字1 */ }
```

#### 3. 组合条件

```javascript
// 使用逻辑运算符
const canAccess = user.isLoggedIn && user.hasPermission && !user.isBlocked;

// 复杂条件的可读性
const isValidUser = user.isLoggedIn 
    && user.emailVerified 
    && user.accountActive 
    && user.subscriptionValid;

// 提取复杂条件为变量
const meetsAgeRequirement = user.age >= 18;
const hasValidId = user.idCard && user.idCard.isValid;
const isVerified = user.emailVerified && user.phoneVerified;

if (meetsAgeRequirement && hasValidId && isVerified) {
    // 处理验证通过的用户
}
```